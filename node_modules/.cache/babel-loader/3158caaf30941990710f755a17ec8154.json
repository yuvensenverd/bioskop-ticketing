{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Enverd\\\\Purwadhika\\\\FrontEnd\\\\bioskopticketing\\\\src\\\\pages\\\\historyTransaction.jsx\";\nimport React from 'react';\nimport { Table } from 'reactstrap';\nimport Axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport numeral from 'numeral';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\n\nclass HistoryTransaction extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      userdata: [],\n      movielist: [],\n      err: \"\",\n      modalOpen: false,\n      currentIndex: 0,\n      Loading: true\n    };\n\n    this.printTotal = arr => {\n      //[{},{}]\n      var total = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        total = total + arr[i].totalprice;\n      }\n\n      return total;\n    };\n\n    this.printDetail = index => {\n      this.setState({\n        modalOpen: true,\n        currentIndex: index\n      });\n    };\n\n    this.printhistory = () => {\n      console.log(this.state.userdata);\n\n      if (this.state.userdata.length !== 0) {\n        var jsx = this.state.userdata.map((val, index) => {\n          return React.createElement(\"tr\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 88\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 89\n            },\n            __self: this\n          }, index + 1), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 90\n            },\n            __self: this\n          }, this.state.userdata[index][0].date), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 91\n            },\n            __self: this\n          }, this.state.userdata[index].length), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 92\n            },\n            __self: this\n          }, \"Rp. \" + numeral(this.printTotal(this.state.userdata[index])).format(0, 0)), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          }, React.createElement(\"input\", {\n            type: \"button\",\n            value: \"detail\",\n            className: \"btn btn-md btn-info\",\n            onClick: () => this.printDetail(index),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 93\n            },\n            __self: this\n          })));\n        });\n        return jsx;\n      } else {}\n    };\n\n    this.mapTotal = () => {\n      var total = 0;\n      this.state.userdata.map((val, index) => {\n        this.state.userdata[index].map(val2 => {\n          total = total + val2.totalprice;\n        });\n      });\n      return total;\n    };\n\n    this.printModal = i => {\n      if (this.state.Loading === false && this.state.userdata.length !== 0) {\n        console.log(this.state.userdata);\n        var output = this.state.userdata[i].map((val, index) => {\n          return React.createElement(\"tr\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 122\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 123\n            },\n            __self: this\n          }, index + 1), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 124\n            },\n            __self: this\n          }, val.movtitle), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 125\n            },\n            __self: this\n          }, val.seat.join(\", \") + \" (Total \" + val.seat.length + \" Ticket)\"), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 126\n            },\n            __self: this\n          }, \"Rp. \" + numeral(val.totalprice).format(0, 0)));\n        });\n        return output;\n      }\n    };\n  }\n\n  componentDidMount() {\n    Axios.get('http://localhost:2000/users?username=' + this.props.currentUser).then(res => {\n      var history = res.data[0].transaction;\n      this.setState({\n        userdata: history\n      });\n\n      if (this.state.userdata.length === 0) {\n        this.setState({\n          err: \"You have no transaction yet !\"\n        });\n      }\n\n      console.log(this.state.userdata);\n      this.setState({\n        Loading: false\n      });\n    }).catch(err => {\n      console.log(err);\n    }); // Axios.get('http://localhost:2000/movies')\n    // .then((res)=>{\n    //   var listorder =  res.data.sort((a,b)=>{\n    //         return (a.id) - (b.id)\n    //     }) // SORT ASCENDING\n    //     var arr = []\n    //     listorder.map((val)=>{\n    //         arr.push(val.title)\n    //     })\n    //     this.setState({\n    //         movielist : arr\n    //     })\n    // })\n    // .catch((err)=>{\n    //     console.log(err)\n    // })\n  }\n\n  render() {\n    if (this.props.IS_LOGGED_IN === false) {\n      return React.createElement(\"div\", {\n        className: \"filtercss text-center pt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, \" Hanya User yang sudah Login yang dapat mengakses \");\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      isOpen: this.state.modalOpen,\n      size: \"lg\",\n      style: {\n        maxWidth: '1200px',\n        width: '80%'\n      },\n      toggle: () => this.setState({\n        modalOpen: false\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(ModalHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"YOUR TRANSACTION DETAILS\"), React.createElement(ModalBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(Table, {\n      light: true,\n      className: \"mt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      className: \"font-weight-bolder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"No\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"Title\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"Qty\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"Subtotal\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, this.printModal(this.state.currentIndex))), React.createElement(\"p\", {\n      id: \"warningbutton\",\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \" \"))), React.createElement(\"div\", {\n      className: \"mycontainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"text-light text-center mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \" Your Transaction History\"), React.createElement(Table, {\n      dark: true,\n      className: \"mt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      className: \"filtercss\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"No\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Date\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"Total Items (Movie)\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"Total Price\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Detail\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, this.printhistory(), React.createElement(\"tr\", {\n      className: \"filtercss text-success\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"Total Money Spent : \"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Rp \" + numeral(this.mapTotal()).format(0, 0)), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    })))), this.state.err === '' ? React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }) : this.state.err !== '' ? React.createElement(\"div\", {\n      className: \"alert alert-black filtercss text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \" \", this.state.err, \" \", React.createElement(\"span\", {\n      style: {\n        fontWeight: \"bolder\",\n        cursor: 'pointer',\n        float: \"right\",\n        height: \"150px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    })) : null), \")\");\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    currentUser: state.CURRENT_USER_DATA.currentUser,\n    IS_ADMIN: state.CURRENT_USER_DATA.IS_ADMIN,\n    IS_LOGGED_IN: state.CURRENT_USER_DATA.IS_LOGGED_IN\n  };\n};\n\nexport default connect(mapStateToProps)(HistoryTransaction);","map":{"version":3,"sources":["C:\\Users\\Enverd\\Purwadhika\\FrontEnd\\bioskopticketing\\src\\pages\\historyTransaction.jsx"],"names":["React","Table","Axios","Link","connect","numeral","Modal","ModalHeader","ModalBody","ModalFooter","HistoryTransaction","Component","state","userdata","movielist","err","modalOpen","currentIndex","Loading","printTotal","arr","total","i","length","totalprice","printDetail","index","setState","printhistory","console","log","jsx","map","val","date","format","mapTotal","val2","printModal","output","movtitle","seat","join","componentDidMount","get","props","currentUser","then","res","history","data","transaction","catch","render","IS_LOGGED_IN","maxWidth","width","color","fontWeight","cursor","float","height","mapStateToProps","CURRENT_USER_DATA","IS_ADMIN"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Table } from 'reactstrap'\r\nimport Axios from 'axios';\r\n\r\nimport { Link } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\nimport numeral from 'numeral'\r\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\r\n\r\n\r\nclass HistoryTransaction extends React.Component{\r\n    state = {\r\n        userdata : [],\r\n        movielist : [],\r\n        err : \"\",\r\n        modalOpen : false,\r\n        currentIndex : 0,\r\n        Loading : true,\r\n      \r\n    }\r\n    componentDidMount(){\r\n        Axios.get('http://localhost:2000/users?username='+ this.props.currentUser)\r\n        .then((res)=>{\r\n            var history  = res.data[0].transaction\r\n            this.setState({\r\n                userdata : history\r\n            })\r\n            if(this.state.userdata.length === 0){\r\n                this.setState({\r\n                    err : \"You have no transaction yet !\"\r\n                })\r\n            }\r\n            console.log(this.state.userdata)\r\n            this.setState({\r\n                Loading : false\r\n            })\r\n            \r\n        })\r\n        .catch((err)=>{\r\n            console.log(err)\r\n        })\r\n\r\n        // Axios.get('http://localhost:2000/movies')\r\n        // .then((res)=>{\r\n        //   var listorder =  res.data.sort((a,b)=>{\r\n        //         return (a.id) - (b.id)\r\n        //     }) // SORT ASCENDING\r\n         \r\n        //     var arr = []\r\n        //     listorder.map((val)=>{\r\n        //         arr.push(val.title)\r\n        //     })\r\n        //     this.setState({\r\n        //         movielist : arr\r\n        //     })\r\n            \r\n\r\n        // })\r\n        // .catch((err)=>{\r\n        //     console.log(err)\r\n        // })\r\n        \r\n       \r\n    }\r\n    printTotal =(arr) => {\r\n        //[{},{}]\r\n        var total = 0 \r\n        for(var i =0; i<arr.length; i++){\r\n            total = total + arr[i].totalprice\r\n        }\r\n     \r\n        return total\r\n    }\r\n\r\n    printDetail =(index)=>{\r\n        this.setState({\r\n            modalOpen : true,\r\n            currentIndex : index\r\n        })\r\n    }\r\n\r\n    printhistory = () =>{\r\n        console.log(this.state.userdata)\r\n        if(this.state.userdata.length !== 0){\r\n            \r\n            var jsx = this.state.userdata.map((val,index)=> {\r\n                return(\r\n                    <tr>\r\n                        <td>{index+1}</td>\r\n                        <td>{this.state.userdata[index][0].date}</td>\r\n                        <td>{this.state.userdata[index].length}</td>\r\n                        <td>{\"Rp. \"+ numeral(this.printTotal(this.state.userdata[index])).format(0,0) }</td>\r\n                        <td><input type=\"button\" value=\"detail\" className=\"btn btn-md btn-info\" onClick={()=>this.printDetail(index)}></input></td>\r\n                    </tr>\r\n                )\r\n            })\r\n            return jsx\r\n        }else {\r\n            \r\n           \r\n                \r\n        }\r\n        \r\n    }\r\n\r\n    mapTotal = () =>{\r\n        var total = 0\r\n        this.state.userdata.map((val,index)=>{\r\n            this.state.userdata[index].map((val2)=>{\r\n                total = total + val2.totalprice\r\n            })\r\n        })\r\n        return total\r\n    }\r\n\r\n    printModal = (i) => {\r\n        if(this.state.Loading === false && this.state.userdata.length !== 0){\r\n\r\n            console.log(this.state.userdata)\r\n            var output = this.state.userdata[i].map((val,index)=>{\r\n                return (\r\n                    <tr>\r\n                        <td>{index+1}</td>\r\n                        <td>{val.movtitle}</td>\r\n                        <td>{val.seat.join(\", \") + \" (Total \" + val.seat.length + \" Ticket)\"}</td>\r\n                        <td>{\"Rp. \"+ numeral(val.totalprice).format(0,0)}</td>\r\n                    </tr>\r\n                )\r\n            })\r\n            return output\r\n        }\r\n    }\r\n\r\n\r\n    render(){\r\n        if(this.props.IS_LOGGED_IN === false){\r\n            return(\r\n                <div className=\"filtercss text-center pt-5\"> Hanya User yang sudah Login yang dapat mengakses </div>\r\n            )\r\n        }\r\n        return(\r\n            <div>\r\n                 <Modal isOpen={this.state.modalOpen} size=\"lg\" style={{maxWidth: '1200px', width: '80%'}} toggle={()=> this.setState({modalOpen : false})}>\r\n                        <ModalHeader>\r\n                            YOUR TRANSACTION DETAILS\r\n                        </ModalHeader>\r\n                        <ModalBody>\r\n                        <Table light className=\"mt-3\">\r\n             \r\n                                <thead>\r\n                                    <tr className=\"font-weight-bolder\">\r\n                                        <td>No</td>\r\n                                        <td>Title</td>\r\n                                        <td>Qty</td>\r\n                                        <td>Subtotal</td>\r\n                                    \r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {this.printModal(this.state.currentIndex)}\r\n                                </tbody>\r\n                        </Table>\r\n                            \r\n                            <p id=\"warningbutton\" style={{color : \"red\"}}> </p>\r\n                        </ModalBody>\r\n                        \r\n                    </Modal>\r\n            \r\n            <div className=\"mycontainer\">\r\n                <h1 className=\"text-light text-center mt-5\"> Your Transaction History</h1>\r\n               <Table dark className=\"mt-3\">\r\n             \r\n                   <thead>\r\n                        <tr className=\"filtercss\">\r\n                            <td>No</td>\r\n                            <td>Date</td>\r\n                            <td>Total Items (Movie)</td>\r\n                            <td>Total Price</td>\r\n                            <td>Detail</td>\r\n                        </tr>\r\n                   </thead>\r\n                   <tbody>\r\n                        \r\n                        {this.printhistory()}\r\n                        <tr className=\"filtercss text-success\"> \r\n                                <td></td>\r\n                                <td></td>\r\n                                <td>Total Money Spent : </td>\r\n                                <td>{\"Rp \" + numeral(this.mapTotal()).format(0,0)}</td>\r\n                                <td></td>\r\n                     </tr>\r\n                        \r\n                   </tbody>\r\n                   \r\n                   \r\n               </Table>\r\n               {\r\n                            this.state.err === '' \r\n                            ?\r\n                            <p></p>\r\n                            :\r\n                            this.state.err !== ''\r\n                            ?\r\n                            <div className='alert alert-black filtercss text-center'> {this.state.err} <span style={{fontWeight : \"bolder\", cursor : 'pointer', float : \"right\", height : \"150px\"}} ></span></div>\r\n                            :\r\n                            null}\r\n                \r\n               \r\n               </div>\r\n           \r\n        \r\n    )\r\n\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return{\r\n       currentUser : state.CURRENT_USER_DATA.currentUser,\r\n       IS_ADMIN : state.CURRENT_USER_DATA.IS_ADMIN,\r\n       IS_LOGGED_IN : state.CURRENT_USER_DATA.IS_LOGGED_IN\r\n       \r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(HistoryTransaction);"]},"metadata":{},"sourceType":"module"}